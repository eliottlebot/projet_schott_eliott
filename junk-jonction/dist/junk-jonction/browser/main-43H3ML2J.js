import{$ as Ae,A as a,B as P,C as ue,D as ce,E as de,F as fe,G as ge,H as he,I as ve,J as be,K as xe,L as Ce,M as b,N as U,O as ye,P as k,Q as Se,R as we,S as ke,T as Ee,U as Re,V as Fe,W as Ie,X as Me,Y as _,Z as N,_ as E,a as d,aa as R,b as w,ba as j,c as te,ca as O,d as Z,da as De,e as oe,ea as He,f as Q,fa as Le,g as f,ga as F,h as C,ha as Pe,i as A,ia as Ue,j as re,ja as D,k as ne,ka as x,l as ie,la as _e,m as ae,ma as Ne,n as m,na as je,o as W,oa as Oe,p as g,pa as Ge,q as le,qa as Te,r as se,s as pe,t as u,u as r,v as n,w as l,x as me,y as v,z as L}from"./chunk-IWHXPLL2.js";var G=class o{constructor(t){this.router=t}canActivate(){return localStorage.getItem("token")?!0:(this.router.navigate(["/user/signup"]),!1)}static \u0275fac=function(e){return new(e||o)(C(b))};static \u0275prov=f({token:o,factory:o.\u0275fac,providedIn:"root"})};var qe=[{path:"pollution",loadChildren:()=>import("./chunk-LAEP3LGN.js").then(o=>o.PollutionModule),canActivate:[G]}];var y=class{constructor(t){this.token=t}static type="[Token] Set"},I=class{static type="[Token] Unset";constructor(){}};var S=class{constructor(t){this.user=t}static type="[User] Set"},M=class{static type="[User] Unset";constructor(){}};var T=class o{constructor(t,e){this.http=t;this.store=e}apiURL=He.apiURL;signup(t){return this.http.post(`${this.apiURL}/users/signup`,t).pipe(Z(e=>(this.store.dispatch(new S(e.data.user)),e.data)))}signin(t){return this.http.post(`${this.apiURL}/users/signin`,t).pipe(Z(e=>(this.store.dispatch(new S(e.data.user)),e.data)))}static \u0275fac=function(e){return new(e||o)(C(ve),C(E))};static \u0275prov=f({token:o,factory:o.\u0275fac,providedIn:"root"})};var q=class o{constructor(t,e){this.userService=t;this.router=e}formTitle="Cr\xE9er un compte";store=A(E);showRecap=!1;signupFormGroup=new D({});signinFormGroup=new D({});ngOnInit(){this.signupFormGroup=new D({login:new x("",F.required),pass:new x("",F.required),confirmPassword:new x("",F.required),nom:new x(""),prenom:new x("")}),this.signinFormGroup=new D({login:new x("",F.required),pass:new x("",F.required)})}onSubmit(){if(!this.checkSignupData()){alert("Please fill in all required fields.");return}this.userService.signup(this.signupFormGroup.value).pipe(Q()).subscribe(t=>{this.store.dispatch(new y(t.token))})}checkSignupData(){let{login:t,pass:e,confirmPassword:i}=this.signupFormGroup.value;return t&&e&&i}handleResetForm(){this.signupFormGroup.reset(),this.showRecap=!1}onSignin(){console.log(this.signinFormGroup.value);let{login:t,pass:e}=this.signinFormGroup.value;if(!t||!e){alert("Veuillez remplir tous les champs de connexion.");return}this.userService.signin(this.signinFormGroup.value).pipe(Q()).subscribe(i=>{this.store.dispatch(new y(i.token)),this.router.navigate(["/"])})}static \u0275fac=function(e){return new(e||o)(W(T),W(b))};static \u0275cmp=g({type:o,selectors:[["app-signup-form"]],inputs:{formTitle:"formTitle"},decls:36,vars:3,consts:[[1,"min-h-screen","flex","items-center","justify-center","p-4","sm:p-8"],[1,"w-full","max-w-4xl","bg-white","rounded-xl","shadow-lg","p-6","sm:p-10"],[1,"text-center","text-2xl","font-semibold","mb-8"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-10"],[1,"bg-slate-50","p-6","rounded-lg","flex","flex-col","gap-4",3,"formGroup"],[1,"text-lg","font-medium","mb-2"],["for","login"],["id","login","formControlName","login","type","text",1,"bg-white","p-2","rounded-lg","border"],["for","password"],["id","password","formControlName","pass","type","password",1,"bg-white","p-2","rounded-lg","border"],["for","confirmPassword"],["id","confirmPassword","formControlName","confirmPassword","type","password",1,"bg-white","p-2","rounded-lg","border"],["for","name"],["id","name","formControlName","nom","type","text",1,"bg-white","p-2","rounded-lg","border"],["for","firstname"],["id","firstname","formControlName","prenom","type","text",1,"bg-white","p-2","rounded-lg","border"],["type","button",1,"mt-4","bg-green-600","text-white","py-2","rounded-lg","hover:bg-green-700","transition",3,"click"],["for","signinLogin"],["for","signinPassword"],["id","pass","formControlName","pass","type","password",1,"bg-white","p-2","rounded-lg","border"],["type","button",1,"mt-4","bg-blue-600","text-white","py-2","rounded-lg","hover:bg-blue-700","transition",3,"click"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"h1",2),a(3),n(),r(4,"div",3)(5,"form",4)(6,"h2",5),a(7,"Inscription"),n(),r(8,"label",6),a(9,"Login"),n(),l(10,"input",7),r(11,"label",8),a(12,"Mot de passe"),n(),l(13,"input",9),r(14,"label",10),a(15,"Confirmer le mot de passe"),n(),l(16,"input",11),r(17,"label",12),a(18,"Nom"),n(),l(19,"input",13),r(20,"label",14),a(21,"Pr\xE9nom"),n(),l(22,"input",15),r(23,"button",16),v("click",function(){return i.onSubmit()}),a(24," Cr\xE9er un compte "),n()(),r(25,"form",4)(26,"h2",5),a(27,"Connexion"),n(),r(28,"label",17),a(29,"Login"),n(),l(30,"input",7),r(31,"label",18),a(32,"Mot de passe"),n(),l(33,"input",19),r(34,"button",20),v("click",function(){return i.onSignin()}),a(35," Se connecter "),n()()()()()),e&2&&(m(3),P(i.formTitle),m(2),u("formGroup",i.signupFormGroup),m(20),u("formGroup",i.signinFormGroup))},dependencies:[Oe,_e,Le,Pe,Ue,Ge,Ne,je],encapsulation:2,changeDetection:0})};var V=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=g({type:o,selectors:[["app-users"]],decls:3,vars:0,consts:[[1,"flex","items-center","justify-around"],[1,"flex-1"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1),l(2,"app-signup-form"),n()())},dependencies:[q],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})};var Je=[{path:"user/signup",component:V,title:"User Signup"}];var $=class o{MoveRight=Fe;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=g({type:o,selectors:[["app-front-page"]],hostAttrs:[1,"flex","flex-col","items-center","justify-center","text-center","gap-4","px-4","bg-[url(/jj-bg.webp)]","h-full","flex-1","bg-cover","bg-center"],decls:13,vars:1,consts:[[1,"bg-white/75","p-4","rounded-lg","h-96","flex","flex-col","items-center","justify-around"],[1,"text-2xl","font-semibold"],["routerLink","pollution",1,"inline-flex","items-center","gap-2","px-3","py-2","rounded-full","font-medium","bg-green-600","hover:bg-green-500","text-white","no-underline"],[1,"flex","gap-2","items-center","justify-center"],[1,"w-5","h-5",3,"img"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"h1",1),a(2,"Bienvenue sur Junk Jonction"),n(),r(3,"div")(4,"p"),a(5,"Ici vous pouvez d\xE9clarer les sites de pollutions \xE0 ciel ouvert que vous d\xE9couvrez"),n(),r(6,"p"),a(7,"Merci de collaborer pour aider la plan\xE8te \xE0 aller mieux !"),n()(),r(8,"a",2)(9,"span",3)(10,"p"),a(11,"D\xE9clarer une pollution"),n(),l(12,"lucide-angular",4),n()()()),e&2&&(m(12),u("img",i.MoveRight))},dependencies:[k,U,N,_],encapsulation:2})};var Ve=[...qe,...Je,{path:"",component:$},{path:"**",redirectTo:""}];var B=class o{constructor(t){this.router=t}intercept(t,e){let i=localStorage.getItem("token"),c=i?t.clone({setHeaders:{Authorization:`Bearer ${i}`}}):t;return e.handle(c).pipe(oe(Y=>((Y.status===401||Y.status===403)&&(localStorage.removeItem("token"),this.router.navigate(["/"])),te(()=>Y))))}static \u0275fac=function(e){return new(e||o)(C(b))};static \u0275prov=f({token:o,factory:o.\u0275fac})};var X="token",s=class{setToken(t,e){t.patchState({token:e.token}),localStorage.setItem(X,e.token)}unsetToken(t){t.patchState({token:null}),localStorage.removeItem(X)}static token(t){return t.token}};w(s,"\u0275fac",function(e){return new(e||s)}),w(s,"\u0275prov",f({token:s,factory:s.\u0275fac})),d([R(y)],s.prototype,"setToken",1),d([R(I)],s.prototype,"unsetToken",1),d([O()],s,"token",1),s=d([j({name:"token",defaults:{token:localStorage.getItem(X)}})],s);var ee="user";function Ke(){let o=localStorage.getItem(ee);return o?JSON.parse(o):null}var p=class{setUser(t,e){t.patchState({user:e.user}),localStorage.setItem(ee,JSON.stringify(e.user))}unsetUser(t){t.patchState({user:null}),localStorage.removeItem(ee)}static user(t){return t.user}};w(p,"\u0275fac",function(e){return new(e||p)}),w(p,"\u0275prov",f({token:p,factory:p.\u0275fac})),d([R(S)],p.prototype,"setUser",1),d([R(M)],p.prototype,"unsetUser",1),d([O()],p,"user",1),p=d([j({name:"user",defaults:{user:Ke()}})],p);var $e={providers:[ae(),de({eventCoalescing:!0}),ye(Ve),xe(),re(Ae.forRoot([s,De,p])),{provide:be,useClass:B,multi:!0}]};function Ye(o,t){if(o&1){let e=me();r(0,"button",12),v("click",function(){ne(e);let c=L();return ie(c.logout())}),r(1,"p"),a(2),n(),l(3,"lucide-angular",13),n()}if(o&2){let e=L();m(2),P(t.login),m(),u("img",e.LogOut)}}function Ze(o,t){if(o&1&&(r(0,"a",11)(1,"p"),a(2,"Connexion"),n(),l(3,"lucide-angular",13),n()),o&2){let e=L();m(3),u("img",e.User)}}var z=class o{LucideHouse=ke;User=Me;List=Ee;ChevronUp=Se;OctagonAlert=Ie;Heart=we;LogOut=Re;store=A(E);router=A(b);token$=this.store.select(s.token);user$=this.store.select(p.user);dropdownOpened=!1;toggleDropdown(){this.dropdownOpened=!this.dropdownOpened}logout(){this.store.dispatch(new I),this.store.dispatch(new M),this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=g({type:o,selectors:[["app-header"]],decls:21,vars:7,consts:[["role","banner",1,"p-4","flex","flex-col","h-full","items-center","justify-between","gap-4","bg-gradient-to-t","from-green-600","to-green-500","text-white","shadow-md"],["routerLink","/","aria-label","Retour \xE0 l'accueil",1,"hover:scale-110","transition-all","duration-300","flex","gap-2"],[1,"my-icon",3,"img"],[1,"hidden","sm:inline"],[1,"flex","flex-col","gap-4"],["routerLink","/pollution",1,"flex","gap-2","hover:scale-110","transition-all","duration-300",3,"click"],[3,"img"],[1,"text-center","flex-1"],["routerLink","/pollution/list",1,"flex","gap-2","hover:scale-110","transition-all","duration-300",3,"click"],["routerLink","/pollution/favorites",1,"flex","gap-2","hover:scale-110","transition-all","duration-300",3,"click"],[1,"inline-flex","items-center","p-2","rounded-full","hover:scale-110","transition-all","duration-300","hover:bg-white/15","cursor-pointer"],["routerLink","user/signup",1,"inline-flex","items-center","p-2","rounded-full","hover:scale-110","transition-all","duration-300","hover:bg-white/15","cursor-pointer"],[1,"inline-flex","items-center","p-2","rounded-full","hover:scale-110","transition-all","duration-300","hover:bg-white/15","cursor-pointer",3,"click"],[1,"ml-2",3,"img"]],template:function(e,i){if(e&1&&(r(0,"header",0)(1,"a",1),l(2,"lucide-angular",2),r(3,"span",3),a(4,"Junk Jonction"),n()(),r(5,"div",4)(6,"a",5),v("click",function(){return i.toggleDropdown()}),l(7,"lucide-angular",6),r(8,"p",7),a(9,"D\xE9clarer une pollution"),n()(),r(10,"a",8),v("click",function(){return i.toggleDropdown()}),l(11,"lucide-angular",6),r(12,"p",7),a(13,"Voir les pollutions"),n()(),r(14,"a",9),v("click",function(){return i.toggleDropdown()}),l(15,"lucide-angular",6),r(16,"p",7),a(17,"Mes favoris"),n()()(),le(18,Ye,4,2,"button",10),ue(19,"async"),se(20,Ze,4,1,"a",11),n()),e&2){let c;m(2),u("img",i.LucideHouse),m(5),u("img",i.OctagonAlert),m(4),u("img",i.List),m(4),u("img",i.Heart),m(3),pe((c=ce(19,5,i.user$))?18:20,c)}},dependencies:[k,U,N,_,ge,fe],encapsulation:2,changeDetection:0})};var K=class o{title="Junk Junction";showPollutionList=!1;togglePollutionList(){this.showPollutionList=!this.showPollutionList}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=g({type:o,selectors:[["app-root"]],hostAttrs:[1,"block","h-full"],decls:4,vars:0,consts:[[1,"h-full","flex"],[1,"flex-1","overflow-auto"]],template:function(e,i){e&1&&(r(0,"div",0),l(1,"app-header"),r(2,"main",1),l(3,"router-outlet"),n()())},dependencies:[Te,k,Ce,z],encapsulation:2})};he(K,$e).catch(o=>console.error(o));
